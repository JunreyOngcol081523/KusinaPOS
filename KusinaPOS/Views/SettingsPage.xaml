<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="KusinaPOS.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:badgeView="clr-namespace:Syncfusion.Maui.Core;assembly=Syncfusion.Maui.Core"
    xmlns:buttons="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
    xmlns:syncfusion="clr-namespace:Syncfusion.Maui.ListView;assembly=Syncfusion.Maui.ListView"
    xmlns:syncfusionex="clr-namespace:Syncfusion.Maui.Expander;assembly=Syncfusion.Maui.Expander"
    xmlns:tabView="clr-namespace:Syncfusion.Maui.TabView;assembly=Syncfusion.Maui.TabView"
    xmlns:viewmodel="clr-namespace:KusinaPOS.ViewModel"
    xmlns:views="clr-namespace:KusinaPOS.Views"
    Title="Settings"
    BackgroundColor="{StaticResource CardBackground}">

    <Grid Padding="16" RowDefinitions="Auto,*">
        <!--  Top Header  -->
        <Grid
            Grid.Row="0"
            Margin="0,0,0,8"
            ColumnDefinitions="Auto,*,Auto,Auto">
            <ImageButton
                Grid.Column="0"
                Margin="0,0,15,0"
                BackgroundColor="Transparent"
                Command="{Binding GoBackCommand}"
                HeightRequest="10"
                Source="arrowback.png"
                WidthRequest="10" />
            <Label
                Grid.Column="1"
                FontAttributes="Bold"
                FontSize="15"
                Text="{Binding StoreName, StringFormat='App Settings - {0}'}"
                TextColor="{StaticResource TextPrimary}"
                VerticalOptions="Center" />

            <Label
                Grid.Column="2"
                Margin="0,0,15,0"
                FontSize="12"
                Text="{Binding CurrentDateTime}"
                TextColor="{StaticResource TextSecondary}"
                VerticalOptions="Center" />

            <HorizontalStackLayout
                Grid.Column="3"
                Spacing="8"
                VerticalOptions="Center">
                <Label
                    FontSize="12"
                    Text="{Binding LoggedInUserName}"
                    TextColor="{StaticResource TextSecondary}"
                    VerticalOptions="Center" />
                <Border
                    BackgroundColor="{StaticResource Primary}"
                    HeightRequest="30"
                    StrokeShape="RoundRectangle 15"
                    WidthRequest="30">
                    <Label
                        FontSize="16"
                        HorizontalOptions="Center"
                        Text="âš™"
                        TextColor="White"
                        VerticalOptions="Center" />
                </Border>
            </HorizontalStackLayout>
        </Grid>
        <tabView:SfTabView
            x:Name="settingTabView"
            Grid.Row="1"
            ContentTransitionDuration="500"
            TabBarCornerRadius="24"
            TabBarPlacement="Bottom">

            <tabView:SfTabView.Items>

                <!--#region store settings-->
                <!--  ================= STORE SETTINGS =================  -->
                <tabView:SfTabItem
                    BackgroundColor="{StaticResource CardBackground}"
                    FontSize="12"
                    Header="Store Settings"
                    ImagePosition="Left"
                    ImageSize="20"
                    ImageSource="settings.png"
                    TextColor="{StaticResource TextPrimary}">
                    <ScrollView>
                        <VerticalStackLayout Padding="8" Spacing="5">

                            <Label
                                FontAttributes="Bold"
                                FontSize="12"
                                Text="Store Information"
                                TextColor="{StaticResource TextPrimary}" />

                            <Entry
                                Placeholder="Store Name"
                                Text="{Binding StoreName}"
                                TextColor="{StaticResource TextPrimary}" />

                            <Entry
                                Placeholder="Store Address"
                                Text="{Binding StoreAddress}"
                                TextColor="{StaticResource TextPrimary}" />

                            <Label
                                FontAttributes="Bold"
                                Text="Store Logo"
                                TextColor="{StaticResource TextPrimary}" />

                            <VerticalStackLayout HeightRequest="220" Spacing="8">

                                <Label
                                    FontAttributes="Bold"
                                    FontSize="13"
                                    Text="Item Image"
                                    TextColor="{StaticResource TextSecondary}" />

                                <Grid ColumnDefinitions="120,*" ColumnSpacing="15">

                                    <Border
                                        Grid.Column="0"
                                        BackgroundColor="{StaticResource BackgroundDarker}"
                                        HeightRequest="120"
                                        Style="{StaticResource CardBorder}"
                                        WidthRequest="120">
                                        <Image
                                            Aspect="AspectFill"
                                            HeightRequest="120"
                                            Source="{Binding StoreImageSource}"
                                            WidthRequest="120" />
                                    </Border>


                                    <Border
                                        Grid.Column="1"
                                        Padding="15"
                                        BackgroundColor="{StaticResource Gray200}"
                                        Stroke="{StaticResource Primary}"
                                        StrokeDashArray="5,5"
                                        StrokeThickness="2"
                                        Style="{StaticResource CardBorder}">
                                        <VerticalStackLayout HorizontalOptions="Center">
                                            <Label FontSize="32" Text="ðŸ“" />
                                            <Label
                                                FontAttributes="Bold"
                                                Text="{Binding ImageLabel}"
                                                TextColor="{StaticResource TextPrimary}" />
                                            <Label
                                                FontSize="11"
                                                Text="PNG, JPG (max. 5MB)"
                                                TextColor="{StaticResource Gray500}" />
                                        </VerticalStackLayout>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding UploadImageCommand}" />
                                        </Border.GestureRecognizers>
                                    </Border>

                                </Grid>
                            </VerticalStackLayout>

                            <Button
                                Command="{Binding SaveStoreSettingsCommand}"
                                Text="Save Store Settings"
                                TextColor="White" />

                        </VerticalStackLayout>
                    </ScrollView>
                </tabView:SfTabItem>
                <!--#endregion-->

                <!--#region database settings-->
                <!--  ================= DATABASE SETTINGS =================  -->
                <tabView:SfTabItem
                    BackgroundColor="{StaticResource CardBackground}"
                    FontSize="12"
                    Header="Database Settings"
                    ImagePosition="Left"
                    ImageSize="20"
                    ImageSource="database.png"
                    TextColor="{StaticResource TextPrimary}">

                    <Grid Padding="8" RowDefinitions="Auto,Auto,Auto,*">

                        <!--  Loading Overlay  -->
                        <ActivityIndicator
                            Grid.RowSpan="4"
                            HeightRequest="50"
                            HorizontalOptions="Center"
                            IsRunning="{Binding IsBusy}"
                            IsVisible="{Binding IsBusy}"
                            VerticalOptions="Center"
                            WidthRequest="50"
                            ZIndex="1"
                            Color="{StaticResource Primary}" />

                        <!--  Header  -->
                        <Label
                            Grid.Row="0"
                            Margin="0,0,0,10"
                            FontAttributes="Bold"
                            FontSize="12"
                            Text="Database Backup"
                            TextColor="{StaticResource TextPrimary}" />

                        <!--  Backup Button  -->
                        <Button
                            Grid.Row="1"
                            Command="{Binding BackupDatabaseCommand}"
                            CornerRadius="8"
                            IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}"
                            Text="Create New Backup"
                            TextColor="White" />

                        <!--  Backup List Header  -->
                        <HorizontalStackLayout
                            Grid.Row="2"
                            Margin="0,8,0,5"
                            HorizontalOptions="Fill"
                            Spacing="5">
                            <badgeView:SfBadgeView BadgeText="{Binding Backups.Count}">
                                <badgeView:SfBadgeView.Content>
                                    <Button Command="{Binding RefreshBackupsCommand}" Text="Backups" />
                                </badgeView:SfBadgeView.Content>
                            </badgeView:SfBadgeView>

                        </HorizontalStackLayout>

                        <!--  Backups List  -->
                        <RefreshView
                            Grid.Row="3"
                            Command="{Binding RefreshBackupsCommand}"
                            IsRefreshing="{Binding IsRefreshing}"
                            RefreshColor="{StaticResource Primary}">

                            <CollectionView ItemsSource="{Binding Backups}" VerticalOptions="Fill">

                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Border
                                            Margin="0,10,0,0"
                                            Padding="12"
                                            Style="{StaticResource CardBorder}">

                                            <Grid
                                                ColumnDefinitions="*,Auto"
                                                RowDefinitions="Auto,Auto,Auto"
                                                RowSpacing="12">

                                                <Label
                                                    Grid.Row="0"
                                                    FontAttributes="Bold"
                                                    FontSize="16"
                                                    Text="{Binding FileName}"
                                                    TextColor="{StaticResource TextPrimary}" />

                                                <HorizontalStackLayout Grid.Row="1" Spacing="15">
                                                    <Label Text="{Binding FormattedDate}" TextColor="{StaticResource TextSecondary}" />
                                                    <Label Text="{Binding FormattedTime}" TextColor="{StaticResource TextSecondary}" />
                                                </HorizontalStackLayout>

                                                <Label
                                                    Grid.Row="2"
                                                    FontSize="13"
                                                    Text="{Binding FileSizeFormatted}"
                                                    TextColor="{StaticResource TextSecondary}" />
                                                <!--  Action Buttons  -->
                                                <HorizontalStackLayout
                                                    Grid.Row="0"
                                                    Grid.RowSpan="3"
                                                    Grid.Column="1"
                                                    Spacing="12"
                                                    VerticalOptions="Center">

                                                    <!--  Share Button  -->
                                                    <Border
                                                        Padding="12"
                                                        BackgroundColor="Transparent"
                                                        HeightRequest="50"
                                                        Stroke="#007AFF"
                                                        StrokeShape="RoundRectangle 8"
                                                        StrokeThickness="1"
                                                        WidthRequest="50">
                                                        <Border.GestureRecognizers>
                                                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.ShareBackupCommand}" CommandParameter="{Binding .}" />
                                                        </Border.GestureRecognizers>
                                                        <Image
                                                            HeightRequest="24"
                                                            HorizontalOptions="Center"
                                                            Source="share.png"
                                                            VerticalOptions="Center"
                                                            WidthRequest="24" />
                                                    </Border>

                                                    <!--  Restore Button  -->
                                                    <Border
                                                        Padding="12"
                                                        BackgroundColor="Transparent"
                                                        HeightRequest="50"
                                                        Stroke="#34C759"
                                                        StrokeShape="RoundRectangle 8"
                                                        StrokeThickness="1"
                                                        WidthRequest="50">
                                                        <Border.GestureRecognizers>
                                                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.RestoreBackupCommand}" CommandParameter="{Binding .}" />
                                                        </Border.GestureRecognizers>
                                                        <Image
                                                            HeightRequest="24"
                                                            HorizontalOptions="Center"
                                                            Source="restore.png"
                                                            VerticalOptions="Center"
                                                            WidthRequest="24" />
                                                    </Border>

                                                    <!--  Delete Button  -->
                                                    <Border
                                                        Padding="12"
                                                        BackgroundColor="Transparent"
                                                        HeightRequest="50"
                                                        Stroke="#FF3B30"
                                                        StrokeShape="RoundRectangle 8"
                                                        StrokeThickness="1"
                                                        WidthRequest="50">
                                                        <Border.GestureRecognizers>
                                                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteBackupCommand}" CommandParameter="{Binding .}" />
                                                        </Border.GestureRecognizers>
                                                        <Image
                                                            HeightRequest="24"
                                                            HorizontalOptions="Center"
                                                            Source="delete.png"
                                                            VerticalOptions="Center"
                                                            WidthRequest="24" />
                                                    </Border>

                                                </HorizontalStackLayout>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>

                                <CollectionView.EmptyView>
                                    <VerticalStackLayout
                                        Padding="40"
                                        HorizontalOptions="Center"
                                        VerticalOptions="Center">
                                        <Label
                                            FontAttributes="Bold"
                                            FontSize="18"
                                            Text="No backups found"
                                            TextColor="#999999" />
                                    </VerticalStackLayout>
                                </CollectionView.EmptyView>

                            </CollectionView>

                        </RefreshView>

                    </Grid>
                </tabView:SfTabItem>
                <!--#endregion-->
                <!--#region POS and categories settings-->
                <!--  ===================PRODUCT SETTINGS===============  -->
                <tabView:SfTabItem
                    BackgroundColor="{StaticResource CardBackground}"
                    FontSize="12"
                    Header="Items and Categories Settings"
                    ImagePosition="Left"
                    ImageSize="20"
                    ImageSource="inventory.png"
                    TextColor="{StaticResource TextPrimary}">
                    <ScrollView>
                        <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="8">
                            <!--#region category settings-->
                            <Border Grid.Row="0" Style="{StaticResource CardBorder}">
                                <syncfusionex:SfExpander AnimationDuration="200" IsExpanded="False">
                                    <syncfusionex:SfExpander.Header>
                                        <Grid Padding="10,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="48" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <!--  Icon  -->
                                            <Image
                                                Grid.Column="0"
                                                HeightRequest="24"
                                                Source="category.png"
                                                VerticalOptions="Center"
                                                WidthRequest="24" />
                                            <!--  Header Text  -->
                                            <Label
                                                Grid.Column="1"
                                                CharacterSpacing="0.25"
                                                FontAttributes="Bold"
                                                FontSize="16"
                                                Text="Category Settings"
                                                TextColor="{StaticResource TextPrimary}"
                                                VerticalOptions="Center" />
                                        </Grid>
                                    </syncfusionex:SfExpander.Header>

                                    <syncfusionex:SfExpander.Content>
                                        <ScrollView Padding="20,15,20,20">
                                            <VerticalStackLayout Spacing="15">
                                                <!--  Add New Category Section  -->
                                                <Label
                                                    Margin="0,0,0,5"
                                                    FontAttributes="Bold"
                                                    FontSize="12"
                                                    Text="Add New Category"
                                                    TextColor="{StaticResource TextPrimary}" />

                                                <Entry
                                                    Margin="0,0,0,10"
                                                    HorizontalOptions="Fill"
                                                    Placeholder="Enter New Category Name"
                                                    PlaceholderColor="{StaticResource TextSecondary}"
                                                    Text="{Binding NewCategoryName}"
                                                    TextColor="{StaticResource TextPrimary}" />

                                                <Button
                                                    Margin="0,0,0,15"
                                                    BackgroundColor="{StaticResource Primary}"
                                                    Command="{Binding AddCategoryCommand}"
                                                    Text="Save" />

                                                <!--  Categories List  -->
                                                <syncfusion:SfListView
                                                    x:Name="listViewcategories"
                                                    ItemSize="100"
                                                    ItemsSource="{Binding Categories}"
                                                    SelectionBackground="Transparent">
                                                    <syncfusion:SfListView.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid Padding="10">
                                                                <badgeView:SfBadgeView
                                                                    BadgeText="{Binding NumberOfMenuUnderThisCategory}"
                                                                    HorizontalOptions="Fill"
                                                                    VerticalOptions="Fill">
                                                                    <badgeView:SfBadgeView.Content>
                                                                        <Border
                                                                            BackgroundColor="{StaticResource CardBackground}"
                                                                            Stroke="#CAC4D0"
                                                                            StrokeShape="RoundRectangle 4,4,4,4"
                                                                            StrokeThickness="1">
                                                                            <Grid
                                                                                Padding="10"
                                                                                ColumnDefinitions="*,Auto"
                                                                                RowDefinitions="Auto">
                                                                                <!--  Category Name  -->
                                                                                <Label
                                                                                    FontSize="14"
                                                                                    Text="{Binding Name}"
                                                                                    TextColor="{StaticResource TextPrimary}"
                                                                                    VerticalOptions="Center" />
                                                                                <!--  Delete Icon  -->
                                                                                <Image
                                                                                    Grid.Column="1"
                                                                                    Margin="5,0"
                                                                                    HeightRequest="20"
                                                                                    Source="delete.png"
                                                                                    VerticalOptions="Center"
                                                                                    WidthRequest="20">
                                                                                    <Image.GestureRecognizers>
                                                                                        <TapGestureRecognizer Command="{Binding Source={x:Reference listViewcategories}, Path=BindingContext.DeleteCategoryCommand}" CommandParameter="{Binding .}" />
                                                                                    </Image.GestureRecognizers>
                                                                                </Image>
                                                                            </Grid>
                                                                        </Border>
                                                                    </badgeView:SfBadgeView.Content>
                                                                </badgeView:SfBadgeView>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </syncfusion:SfListView.ItemTemplate>
                                                    <syncfusion:SfListView.ItemsLayout>
                                                        <syncfusion:GridLayout SpanCount="4" />
                                                    </syncfusion:SfListView.ItemsLayout>
                                                </syncfusion:SfListView>
                                            </VerticalStackLayout>
                                        </ScrollView>
                                    </syncfusionex:SfExpander.Content>
                                </syncfusionex:SfExpander>
                            </Border>
                            <!--#endregion-->

                            <!--#region POS settings-->
                            <Border Grid.Row="1" Style="{StaticResource CardBorder}">
                                <syncfusionex:SfExpander AnimationDuration="200" IsExpanded="False">
                                    <syncfusionex:SfExpander.Header>
                                        <Grid Padding="10,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="48" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <!--  Icon  -->
                                            <Image
                                                Grid.Column="0"
                                                HeightRequest="24"
                                                Source="pos.png"
                                                VerticalOptions="Center"
                                                WidthRequest="24" />
                                            <!--  Header Text  -->
                                            <Label
                                                Grid.Column="1"
                                                CharacterSpacing="0.25"
                                                FontAttributes="Bold"
                                                FontSize="16"
                                                Text="POS Settings"
                                                TextColor="{StaticResource TextPrimary}"
                                                VerticalOptions="Center" />
                                        </Grid>
                                    </syncfusionex:SfExpander.Header>

                                    <syncfusionex:SfExpander.Content>
                                        <ScrollView Padding="20,15,20,20">
                                            <VerticalStackLayout Spacing="25">

                                                <!--  Discount Settings Section  -->
                                                <Border
                                                    Padding="15"
                                                    BackgroundColor="{StaticResource CardBackground}"
                                                    Stroke="{StaticResource TextSecondary}"
                                                    StrokeShape="RoundRectangle 8"
                                                    StrokeThickness="1">
                                                    <VerticalStackLayout Spacing="12">
                                                        <!--  Section Header with Icon  -->
                                                        <HorizontalStackLayout Spacing="8">
                                                            <Label
                                                                FontSize="18"
                                                                Text="ðŸ’°"
                                                                VerticalOptions="Center" />
                                                            <Label
                                                                FontAttributes="Bold"
                                                                FontSize="14"
                                                                Text="Discount Settings"
                                                                TextColor="{StaticResource TextPrimary}"
                                                                VerticalOptions="Center" />
                                                        </HorizontalStackLayout>

                                                        <BoxView
                                                            Margin="0,5,0,10"
                                                            HeightRequest="1"
                                                            Opacity="0.3"
                                                            Color="{StaticResource TextSecondary}" />

                                                        <!--  Enable/Disable Toggle  -->
                                                        <Border
                                                            Padding="12"
                                                            BackgroundColor="{StaticResource CardBackground}"
                                                            StrokeShape="RoundRectangle 6">
                                                            <Grid ColumnDefinitions="*,Auto">
                                                                <Label
                                                                    FontSize="13"
                                                                    Text="Enable Discount"
                                                                    TextColor="{StaticResource TextPrimary}"
                                                                    VerticalOptions="Center" />
                                                                <Switch
                                                                    Grid.Column="1"
                                                                    IsToggled="{Binding AllowDiscount, Mode=TwoWay}"
                                                                    VerticalOptions="Center" />
                                                            </Grid>
                                                        </Border>

                                                        <!--  Discount Type Selection  -->
                                                        <Label
                                                            Margin="0,8,0,5"
                                                            FontAttributes="Bold"
                                                            FontSize="12"
                                                            Text="Discount Type"
                                                            TextColor="{StaticResource TextPrimary}" />

                                                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                                                            <Border
                                                                Grid.Column="0"
                                                                Padding="10,8"
                                                                BackgroundColor="{StaticResource CardBackground}"
                                                                Stroke="{StaticResource TextSecondary}"
                                                                StrokeShape="RoundRectangle 6"
                                                                StrokeThickness="1">
                                                                <RadioButton
                                                                    Content="Fixed Amount"
                                                                    FontSize="12"
                                                                    IsChecked="{Binding IsDiscountFixedAmount, Mode=TwoWay}"
                                                                    TextColor="{StaticResource TextPrimary}" />
                                                            </Border>

                                                            <Border
                                                                Grid.Column="1"
                                                                Padding="10,8"
                                                                BackgroundColor="{StaticResource CardBackground}"
                                                                Stroke="{StaticResource TextSecondary}"
                                                                StrokeShape="RoundRectangle 6"
                                                                StrokeThickness="1">
                                                                <RadioButton
                                                                    Content="Percentage"
                                                                    FontSize="12"
                                                                    IsChecked="{Binding IsDiscountPercentage, Mode=TwoWay}"
                                                                    TextColor="{StaticResource TextPrimary}" />
                                                            </Border>
                                                        </Grid>

                                                        <!--  Discount Value Input  -->
                                                        <Label
                                                            Margin="0,8,0,5"
                                                            FontAttributes="Bold"
                                                            FontSize="12"
                                                            Text="Discount Value"
                                                            TextColor="{StaticResource TextPrimary}" />

                                                        <Border
                                                            Padding="2"
                                                            Stroke="{StaticResource TextSecondary}"
                                                            StrokeShape="RoundRectangle 6"
                                                            StrokeThickness="1">
                                                            <Entry
                                                                BackgroundColor="Transparent"
                                                                Keyboard="Numeric"
                                                                Placeholder="Enter amount or percentage"
                                                                PlaceholderColor="{StaticResource TextSecondary}"
                                                                Text="{Binding DiscountValue, Mode=TwoWay}"
                                                                TextColor="{StaticResource TextPrimary}" />
                                                        </Border>
                                                    </VerticalStackLayout>
                                                </Border>

                                                <!--  VAT Settings Section  -->
                                                <Border
                                                    Padding="15"
                                                    BackgroundColor="{StaticResource CardBackground}"
                                                    Stroke="{StaticResource TextSecondary}"
                                                    StrokeShape="RoundRectangle 8"
                                                    StrokeThickness="1">
                                                    <VerticalStackLayout Spacing="12">
                                                        <!--  Section Header with Icon  -->
                                                        <HorizontalStackLayout Spacing="8">
                                                            <Label
                                                                FontSize="18"
                                                                Text="ðŸ“Š"
                                                                VerticalOptions="Center" />
                                                            <Label
                                                                FontAttributes="Bold"
                                                                FontSize="14"
                                                                Text="VAT Settings"
                                                                TextColor="{StaticResource TextPrimary}"
                                                                VerticalOptions="Center" />
                                                        </HorizontalStackLayout>

                                                        <BoxView
                                                            Margin="0,5,0,10"
                                                            HeightRequest="1"
                                                            Opacity="0.3"
                                                            Color="{StaticResource TextSecondary}" />

                                                        <!--  Enable/Disable Toggle  -->
                                                        <Border
                                                            Padding="12"
                                                            BackgroundColor="{StaticResource CardBackground}"
                                                            StrokeShape="RoundRectangle 6">
                                                            <Grid ColumnDefinitions="*,Auto">
                                                                <Label
                                                                    FontSize="13"
                                                                    Text="Enable VAT"
                                                                    TextColor="{StaticResource TextPrimary}"
                                                                    VerticalOptions="Center" />
                                                                <Switch
                                                                    Grid.Column="1"
                                                                    IsToggled="{Binding AllowVAT, Mode=TwoWay}"
                                                                    VerticalOptions="Center" />
                                                            </Grid>
                                                        </Border>

                                                        <!--  VAT Value Input  -->
                                                        <Label
                                                            Margin="0,8,0,5"
                                                            FontAttributes="Bold"
                                                            FontSize="12"
                                                            Text="VAT %"
                                                            TextColor="{StaticResource TextPrimary}" />

                                                        <Border
                                                            Padding="2"
                                                            Stroke="{StaticResource TextSecondary}"
                                                            StrokeShape="RoundRectangle 6"
                                                            StrokeThickness="1">
                                                            <Entry
                                                                BackgroundColor="Transparent"
                                                                Keyboard="Numeric"
                                                                Placeholder="Enter VAT percentage"
                                                                PlaceholderColor="{StaticResource TextSecondary}"
                                                                Text="{Binding VatValue, Mode=TwoWay}"
                                                                TextColor="{StaticResource TextPrimary}" />
                                                        </Border>
                                                    </VerticalStackLayout>
                                                </Border>

                                                <!--  Printer Settings Section  -->
                                                <Border
                                                    Padding="15"
                                                    BackgroundColor="{StaticResource CardBackground}"
                                                    Stroke="{StaticResource TextSecondary}"
                                                    StrokeShape="RoundRectangle 8"
                                                    StrokeThickness="1">
                                                    <VerticalStackLayout Spacing="12">
                                                        <!--  Section Header with Icon  -->
                                                        <HorizontalStackLayout Spacing="8">
                                                            <Label
                                                                FontSize="18"
                                                                Text="ðŸ–¨ï¸"
                                                                VerticalOptions="Center" />
                                                            <Label
                                                                FontAttributes="Bold"
                                                                FontSize="14"
                                                                Text="Printer Settings"
                                                                TextColor="{StaticResource TextPrimary}"
                                                                VerticalOptions="Center" />
                                                        </HorizontalStackLayout>

                                                        <BoxView
                                                            Margin="0,5,0,10"
                                                            HeightRequest="1"
                                                            Opacity="0.3"
                                                            Color="{StaticResource TextSecondary}" />

                                                        <!--  Enable/Disable Toggle  -->
                                                        <Border
                                                            Padding="12"
                                                            BackgroundColor="{StaticResource CardBackground}"
                                                            StrokeShape="RoundRectangle 6">
                                                            <Grid ColumnDefinitions="*,Auto">
                                                                <Label
                                                                    FontSize="13"
                                                                    Text="Enable Printing"
                                                                    TextColor="{StaticResource TextPrimary}"
                                                                    VerticalOptions="Center" />
                                                                <Switch
                                                                    Grid.Column="1"
                                                                    IsToggled="{Binding AllowPrint, Mode=TwoWay}"
                                                                    VerticalOptions="Center" />
                                                            </Grid>
                                                        </Border>

                                                        <!--  Printer Discovery  -->
                                                        <Label
                                                            Margin="0,8,0,5"
                                                            FontAttributes="Bold"
                                                            FontSize="12"
                                                            Text="Discover Printers"
                                                            TextColor="{StaticResource TextPrimary}" />

                                                        <Button
                                                            BackgroundColor="{StaticResource Primary}"
                                                            Command="{Binding FindPrinterCommand}"
                                                            CornerRadius="6"
                                                            HeightRequest="44"
                                                            Text="ðŸ” Find Bluetooth Printers"
                                                            TextColor="White" />

                                                        <!--  Printer Selection  -->
                                                        <Label
                                                            Margin="0,8,0,5"
                                                            FontAttributes="Bold"
                                                            FontSize="12"
                                                            Text="Select Printer"
                                                            TextColor="{StaticResource TextPrimary}" />

                                                        <Border
                                                            Padding="2"
                                                            Stroke="{StaticResource TextSecondary}"
                                                            StrokeShape="RoundRectangle 6"
                                                            StrokeThickness="1">
                                                            <Picker
                                                                Title="Choose a printer"
                                                                BackgroundColor="Transparent"
                                                                ItemsSource="{Binding AvailablePrinters}"
                                                                SelectedItem="{Binding SelectedPrinter}"
                                                                TextColor="{StaticResource TextPrimary}" />
                                                        </Border>

                                                        <!--  Connect Button  -->
                                                        <Button
                                                            Margin="0,8,0,0"
                                                            BackgroundColor="{StaticResource Primary}"
                                                            Command="{Binding ConnectPrinterCommand}"
                                                            CornerRadius="6"
                                                            HeightRequest="44"
                                                            Text="ðŸ”— Connect to Printer"
                                                            TextColor="White" />

                                                        <!--  Connection Status  -->
                                                        <Border
                                                            Margin="0,5,0,0"
                                                            Padding="12"
                                                            BackgroundColor="{StaticResource CardBackground}"
                                                            StrokeShape="RoundRectangle 6">
                                                            <Label
                                                                FontSize="12"
                                                                HorizontalOptions="Center"
                                                                HorizontalTextAlignment="Center"
                                                                Text="{Binding PrinterConnectionStatus}"
                                                                TextColor="{Binding PrinterConnectionStatusColor}" />
                                                        </Border>
                                                    </VerticalStackLayout>
                                                </Border>

                                            </VerticalStackLayout>
                                        </ScrollView>
                                    </syncfusionex:SfExpander.Content>
                                </syncfusionex:SfExpander>
                            </Border>
                            <!--#endregion-->

                            <!--#region inventory settings-->
                            <Border Grid.Row="2" Style="{StaticResource CardBorder}">
                                <syncfusionex:SfExpander AnimationDuration="200" IsExpanded="False">
                                    <syncfusionex:SfExpander.Header>
                                        <Grid Padding="10,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="48" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <!--  Icon  -->
                                            <Image
                                                Grid.Column="0"
                                                HeightRequest="24"
                                                Source="shelves.png"
                                                VerticalOptions="Center"
                                                WidthRequest="24" />
                                            <!--  Header Text  -->
                                            <Label
                                                Grid.Column="1"
                                                CharacterSpacing="0.25"
                                                FontAttributes="Bold"
                                                FontSize="16"
                                                Text="Inventory Items"
                                                TextColor="{StaticResource TextPrimary}"
                                                VerticalOptions="Center" />
                                        </Grid>
                                    </syncfusionex:SfExpander.Header>

                                    <syncfusionex:SfExpander.Content>
                                        <ScrollView Padding="20,15,20,20">
                                            <VerticalStackLayout Spacing="15">
                                                <!--  INSTRUCTION  -->
                                                <Label
                                                    FontSize="12"
                                                    Text="Download the Excel template, fill in your inventory items, then import the completed file to add items faster."
                                                    TextColor="{StaticResource TextSecondary}" />

                                                <!--  ACTION BUTTONS  -->
                                                <HorizontalStackLayout Spacing="10">
                                                    <Button
                                                        Padding="12,6"
                                                        BackgroundColor="{StaticResource Primary}"
                                                        Command="{Binding DownloadTemplateCommand}"
                                                        CornerRadius="6"
                                                        FontSize="12"
                                                        Text="Download Template"
                                                        TextColor="White" />

                                                    <Button
                                                        Padding="12,6"
                                                        BackgroundColor="{StaticResource Primary}"
                                                        Command="{Binding ImportTemplateCommand}"
                                                        CornerRadius="6"
                                                        FontSize="12"
                                                        Text="Import Template"
                                                        TextColor="White" />
                                                </HorizontalStackLayout>
                                            </VerticalStackLayout>
                                        </ScrollView>
                                    </syncfusionex:SfExpander.Content>
                                </syncfusionex:SfExpander>
                            </Border>
                            <!--#endregion-->

                            <!--#region Refund Sale settings-->
                            <Border
                                Grid.Row="3"
                                BindingContext="{Binding RefundSaleVM}"
                                Style="{StaticResource CardBorder}">
                                <syncfusionex:SfExpander AnimationDuration="200" IsExpanded="False">
                                    <syncfusionex:SfExpander.Header>
                                        <Grid Padding="10,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="48" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <!--  Icon  -->
                                            <Image
                                                Grid.Column="0"
                                                HeightRequest="24"
                                                Source="sales.png"
                                                VerticalOptions="Center"
                                                WidthRequest="24" />
                                            <!--  Header Text  -->
                                            <Label
                                                Grid.Column="1"
                                                CharacterSpacing="0.25"
                                                FontAttributes="Bold"
                                                FontSize="16"
                                                Text="Sale Settings"
                                                TextColor="{StaticResource TextPrimary}"
                                                VerticalOptions="Center" />
                                        </Grid>
                                    </syncfusionex:SfExpander.Header>

                                    <syncfusionex:SfExpander.Content>
                                        <ScrollView Padding="20,15,20,20">
                                            <!--  Two Column Layout  -->
                                            <Grid
                                                ColumnDefinitions="*,*"
                                                ColumnSpacing="20"
                                                RowDefinitions="Auto,Auto">

                                                <!--  LEFT COLUMN  -->
                                                <VerticalStackLayout
                                                    Grid.Row="0"
                                                    Grid.Column="0"
                                                    Spacing="20">


                                                    <!--  Search Sale Section  -->
                                                    <Border
                                                        Padding="15"
                                                        BackgroundColor="{StaticResource CardBackground}"
                                                        Stroke="{StaticResource TextSecondary}"
                                                        StrokeShape="RoundRectangle 8"
                                                        StrokeThickness="1">
                                                        <Grid
                                                            ColumnDefinitions="180, *, 160"
                                                            ColumnSpacing="15"
                                                            RowDefinitions="Auto">

                                                            <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                                                                <Label
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Select Mode"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <buttons:SfRadioGroup x:Name="radioGroup" Orientation="Horizontal">
                                                                    <buttons:SfRadioButton
                                                                        x:Name="Void"
                                                                        CheckedColor="{StaticResource Primary}"
                                                                        IsChecked="{Binding SelectedMode, Converter={StaticResource EnumToStringConverter}, ConverterParameter=Voided}"
                                                                        Text="Void"
                                                                        TextColor="{StaticResource TextPrimary}" />
                                                                    <buttons:SfRadioButton
                                                                        x:Name="Refund"
                                                                        CheckedColor="{StaticResource Primary}"
                                                                        IsChecked="{Binding SelectedMode, Converter={StaticResource EnumToStringConverter}, ConverterParameter=Refunded}"
                                                                        Text="Refund"
                                                                        TextColor="{StaticResource TextPrimary}" />
                                                                </buttons:SfRadioGroup>
                                                            </VerticalStackLayout>

                                                            <VerticalStackLayout
                                                                Grid.Column="1"
                                                                Spacing="2"
                                                                VerticalOptions="End">
                                                                <Label
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Search Sale Transaction"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Border
                                                                    Padding="2"
                                                                    Stroke="{StaticResource TextSecondary}"
                                                                    StrokeShape="RoundRectangle 6"
                                                                    StrokeThickness="1">
                                                                    <Entry
                                                                        BackgroundColor="Transparent"
                                                                        Placeholder="Enter Receipt No"
                                                                        PlaceholderColor="{StaticResource TextSecondary}"
                                                                        Text="{Binding SearchReceiptNo, Mode=TwoWay}"
                                                                        TextColor="{StaticResource TextPrimary}" />
                                                                </Border>
                                                            </VerticalStackLayout>

                                                            <Button
                                                                Grid.Column="2"
                                                                Margin="0,0,0,1"
                                                                BackgroundColor="{StaticResource Primary}"
                                                                Command="{Binding FindSaleCommand}"
                                                                CornerRadius="6"
                                                                HeightRequest="44"
                                                                Text="ðŸ” Find Transaction"
                                                                TextColor="White"
                                                                VerticalOptions="End"
                                                                WidthRequest="160" />

                                                        </Grid>
                                                    </Border>

                                                    <!--  Sale Details Section  -->
                                                    <Border
                                                        Padding="15"
                                                        BackgroundColor="{StaticResource CardBackground}"
                                                        IsVisible="{Binding IsSaleFound}"
                                                        Stroke="{StaticResource TextSecondary}"
                                                        StrokeShape="RoundRectangle 8"
                                                        StrokeThickness="1">
                                                        <VerticalStackLayout Spacing="12">
                                                            <!--  Section Header  -->
                                                            <HorizontalStackLayout Spacing="8">
                                                                <Label
                                                                    FontSize="18"
                                                                    Text="ðŸ“„"
                                                                    VerticalOptions="Center" />
                                                                <Label
                                                                    FontAttributes="Bold"
                                                                    FontSize="14"
                                                                    Text="Sale Details"
                                                                    TextColor="{StaticResource TextPrimary}"
                                                                    VerticalOptions="Center" />
                                                            </HorizontalStackLayout>

                                                            <BoxView
                                                                Margin="0,5,0,10"
                                                                HeightRequest="1"
                                                                Opacity="0.3"
                                                                Color="{StaticResource TextSecondary}" />

                                                            <Grid
                                                                ColumnDefinitions="Auto,*"
                                                                ColumnSpacing="10"
                                                                RowDefinitions="Auto,Auto,Auto,Auto,Auto"
                                                                RowSpacing="10">

                                                                <Label
                                                                    Grid.Row="0"
                                                                    Grid.Column="0"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Receipt No:"
                                                                    TextColor="{StaticResource TextSecondary}" />
                                                                <Label
                                                                    Grid.Row="0"
                                                                    Grid.Column="1"
                                                                    FontSize="12"
                                                                    Text="{Binding SelectedSaleTransaction.ReceiptNo}"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Label
                                                                    Grid.Row="1"
                                                                    Grid.Column="0"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Date:"
                                                                    TextColor="{StaticResource TextSecondary}" />
                                                                <Label
                                                                    Grid.Row="1"
                                                                    Grid.Column="1"
                                                                    FontSize="12"
                                                                    Text="{Binding SelectedSaleTransaction.SaleDate, StringFormat='{0:MMM dd, yyyy hh:mm tt}'}"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Label
                                                                    Grid.Row="2"
                                                                    Grid.Column="0"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Total:"
                                                                    TextColor="{StaticResource TextSecondary}" />
                                                                <Label
                                                                    Grid.Row="2"
                                                                    Grid.Column="1"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="{Binding SelectedSaleTransaction.TotalAmount, StringFormat='â‚±{0:N2}'}"
                                                                    TextColor="{StaticResource Primary}" />

                                                                <Label
                                                                    Grid.Row="3"
                                                                    Grid.Column="0"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Status:"
                                                                    TextColor="{StaticResource TextSecondary}" />
                                                                <Label
                                                                    Grid.Row="3"
                                                                    Grid.Column="1"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="{Binding SelectedSaleTransaction.Status}"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Label
                                                                    Grid.Row="4"
                                                                    Grid.Column="0"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Action Date:"
                                                                    TextColor="{StaticResource TextSecondary}" />
                                                                <Label
                                                                    Grid.Row="4"
                                                                    Grid.Column="1"
                                                                    FontSize="12"
                                                                    Text="{Binding SelectedSaleTransaction.ActionDate, StringFormat='{0:MMM dd, yyyy hh:mm tt}', TargetNullValue='-'}"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                            </Grid>

                                                            <!--  Sale Items List  -->
                                                            <Label
                                                                Margin="0,10,0,5"
                                                                FontAttributes="Bold"
                                                                FontSize="12"
                                                                Text="Sale Items"
                                                                TextColor="{StaticResource TextPrimary}" />

                                                            <syncfusion:SfListView
                                                                ItemSize="55"
                                                                ItemsSource="{Binding SaleItems}"
                                                                SelectionBackground="Transparent">
                                                                <syncfusion:SfListView.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <Border
                                                                            Margin="0,2"
                                                                            Padding="8"
                                                                            BackgroundColor="{StaticResource CardBackground}"
                                                                            Stroke="#CAC4D0"
                                                                            StrokeShape="RoundRectangle 4"
                                                                            StrokeThickness="1">
                                                                            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                                                                <!--  Item Name  -->
                                                                                <Label
                                                                                    Grid.Row="0"
                                                                                    Grid.Column="0"
                                                                                    FontAttributes="Bold"
                                                                                    FontSize="12"
                                                                                    Text="{Binding MenuItemName}"
                                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                                <!--  Quantity  -->
                                                                                <Label
                                                                                    Grid.Row="1"
                                                                                    Grid.Column="0"
                                                                                    FontSize="10"
                                                                                    Text="{Binding Quantity, StringFormat='Qty: {0} @ â‚±{1:N2}', ConverterParameter={Binding UnitPrice}}"
                                                                                    TextColor="{StaticResource TextSecondary}" />

                                                                                <!--  Total  -->
                                                                                <Label
                                                                                    Grid.Row="0"
                                                                                    Grid.RowSpan="2"
                                                                                    Grid.Column="1"
                                                                                    FontAttributes="Bold"
                                                                                    FontSize="12"
                                                                                    Text="{Binding LineTotal, StringFormat='â‚±{0:N2}'}"
                                                                                    TextColor="{StaticResource Primary}"
                                                                                    VerticalOptions="Center" />
                                                                            </Grid>
                                                                        </Border>
                                                                    </DataTemplate>
                                                                </syncfusion:SfListView.ItemTemplate>
                                                            </syncfusion:SfListView>
                                                        </VerticalStackLayout>
                                                    </Border>

                                                </VerticalStackLayout>

                                                <!--  RIGHT COLUMN  -->
                                                <VerticalStackLayout
                                                    Grid.Row="0"
                                                    Grid.Column="1"
                                                    Spacing="20">

                                                    <Border
                                                        Padding="15"
                                                        BackgroundColor="{StaticResource CardBackground}"
                                                        Stroke="{StaticResource TextSecondary}"
                                                        StrokeShape="RoundRectangle 8"
                                                        StrokeThickness="1">
                                                        <VerticalStackLayout Spacing="12">
                                                            <VerticalStackLayout>
                                                                <HorizontalStackLayout Spacing="8">
                                                                    <Label
                                                                        FontSize="18"
                                                                        Text="ðŸ”"
                                                                        VerticalOptions="Center" />
                                                                    <Label
                                                                        FontAttributes="Bold"
                                                                        FontSize="14"
                                                                        Text="Authorization and Details"
                                                                        TextColor="{StaticResource TextPrimary}"
                                                                        VerticalOptions="Center" />
                                                                </HorizontalStackLayout>

                                                                <BoxView
                                                                    Margin="0,5,0,10"
                                                                    HeightRequest="1"
                                                                    Opacity="0.3"
                                                                    Color="{StaticResource TextSecondary}" />

                                                                <Label
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Admin Password"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Entry
                                                                    BackgroundColor="Transparent"
                                                                    IsPassword="True"
                                                                    Placeholder="Enter admin password"
                                                                    PlaceholderColor="{StaticResource TextSecondary}"
                                                                    Text="{Binding AdminPassword, Mode=TwoWay}"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Label
                                                                    Margin="0,8,0,0"
                                                                    FontAttributes="Bold"
                                                                    FontSize="12"
                                                                    Text="Reason for Void"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Editor
                                                                    BackgroundColor="Transparent"
                                                                    HeightRequest="70"
                                                                    Placeholder="Enter reason for voiding this sale"
                                                                    PlaceholderColor="{StaticResource TextSecondary}"
                                                                    Text="{Binding VoidReason, Mode=TwoWay}"
                                                                    TextColor="{StaticResource TextPrimary}" />

                                                                <Grid
                                                                    Margin="0,8,0,0"
                                                                    ColumnDefinitions="*,*"
                                                                    ColumnSpacing="10"
                                                                    RowDefinitions="Auto,Auto,Auto,Auto"
                                                                    RowSpacing="8">

                                                                    <Label
                                                                        Grid.Row="0"
                                                                        Grid.Column="0"
                                                                        FontAttributes="Bold"
                                                                        FontSize="12"
                                                                        Text="Customer Name"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Label
                                                                        Grid.Row="0"
                                                                        Grid.Column="1"
                                                                        FontAttributes="Bold"
                                                                        FontSize="12"
                                                                        Text="Customer Contact"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Entry
                                                                        Grid.Row="1"
                                                                        Grid.Column="0"
                                                                        BackgroundColor="Transparent"
                                                                        IsEnabled="{Binding IsRefundMode}"
                                                                        Placeholder="Customer name"
                                                                        PlaceholderColor="{StaticResource TextSecondary}"
                                                                        Text="{Binding CustomerName, Mode=TwoWay}"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Entry
                                                                        Grid.Row="1"
                                                                        Grid.Column="1"
                                                                        BackgroundColor="Transparent"
                                                                        IsEnabled="{Binding IsRefundMode}"
                                                                        Keyboard="Telephone"
                                                                        Placeholder="Contact number"
                                                                        PlaceholderColor="{StaticResource TextSecondary}"
                                                                        Text="{Binding CustomerContact, Mode=TwoWay}"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Label
                                                                        Grid.Row="2"
                                                                        Grid.Column="0"
                                                                        Margin="0,8,0,0"
                                                                        FontAttributes="Bold"
                                                                        FontSize="12"
                                                                        Text="Refunded Amount"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Label
                                                                        Grid.Row="2"
                                                                        Grid.Column="1"
                                                                        Margin="0,8,0,0"
                                                                        FontAttributes="Bold"
                                                                        FontSize="12"
                                                                        Text="Authorized By"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Entry
                                                                        Grid.Row="3"
                                                                        Grid.Column="0"
                                                                        BackgroundColor="Transparent"
                                                                        IsEnabled="{Binding IsRefundMode}"
                                                                        Keyboard="Numeric"
                                                                        Placeholder="Refund amount"
                                                                        PlaceholderColor="{StaticResource TextSecondary}"
                                                                        Text="{Binding RefundedAmount, Mode=TwoWay}"
                                                                        TextColor="{StaticResource TextPrimary}" />

                                                                    <Entry
                                                                        Grid.Row="3"
                                                                        Grid.Column="1"
                                                                        BackgroundColor="Transparent"
                                                                        Placeholder="Manager/Admin name"
                                                                        PlaceholderColor="{StaticResource TextSecondary}"
                                                                        Text="{Binding AuthorizedBy, Mode=TwoWay}"
                                                                        TextColor="{StaticResource TextPrimary}" />
                                                                </Grid>

                                                                <Label
                                                                    Margin="5,5,0,0"
                                                                    FontSize="11"
                                                                    Text="{Binding FoundSale.TotalAmount, StringFormat='Maximum refund: â‚±{0:N2}'}"
                                                                    TextColor="{StaticResource Secondary}" />
                                                            </VerticalStackLayout>

                                                            <Button
                                                                Margin="0,15,0,0"
                                                                BackgroundColor="{Binding ButtonColor}"
                                                                Command="{Binding ProcessVoidSaleCommand}"
                                                                CornerRadius="6"
                                                                HeightRequest="48"
                                                                Text="{Binding ButtonText}"
                                                                TextColor="White" />
                                                        </VerticalStackLayout>
                                                    </Border>

                                                </VerticalStackLayout>

                                            </Grid>
                                        </ScrollView>
                                    </syncfusionex:SfExpander.Content>
                                </syncfusionex:SfExpander>
                            </Border>
                            <!--#endregion-->
                        </Grid>
                    </ScrollView>

                </tabView:SfTabItem>
                <!--#endregion-->
                <!--#region about settings-->
                <!--  ================= ABOUT SETTINGS =================  -->
                <tabView:SfTabItem
                    FontSize="12"
                    Header="About"
                    ImagePosition="Left"
                    ImageSize="20"
                    ImageSource="info.png"
                    TextColor="{StaticResource TextPrimary}">

                    <Grid RowDefinitions="Auto,*">
                        <Image
                            Grid.Row="0"
                            HeightRequest="80"
                            HorizontalOptions="Center"
                            Source="kusinaposlogo.png" />
                        <WebView
                            x:Name="AboutWebView"
                            Grid.Row="1"
                            HorizontalOptions="Fill"
                            VerticalOptions="Fill" />
                    </Grid>

                </tabView:SfTabItem>
                <!--#endregion-->

            </tabView:SfTabView.Items>

        </tabView:SfTabView>


    </Grid>
</ContentPage>
